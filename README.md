# Python-Actions.GoodInfo - GoodInfo.tw XLS Downloader

ğŸš€ Automated XLS file downloader for Taiwan stock data from GoodInfo.tw using Selenium

## Status

Update time: 2026-01-28 13:06:46 CST

| No | Folder | Total | Success | Failed | Updated from now | Oldest | Duration | Retry Rate |
| -- | -- | -- | -- | -- | -- | -- | -- | -- |
| 1 | DividendDetail | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/17h_39m_ago-blue) | ![](https://img.shields.io/badge/18h_37m_ago-blue) | ![](https://img.shields.io/badge/59m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 2 | BasicInfo |  |  |  | N/A | N/A | N/A | N/A |
| 3 | StockDetail |  |  |  | N/A | N/A | N/A | N/A |
| 4 | StockBzPerformance | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/21h_23m_ago-blue) | ![](https://img.shields.io/badge/22h_31m_ago-blue) | ![](https://img.shields.io/badge/1h_8m-blue) | ![](https://img.shields.io/badge/1.1x-green) |
| 5 | ShowSaleMonChart | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/5d_8h_ago-red) | ![](https://img.shields.io/badge/5d_10h_ago-red) | ![](https://img.shields.io/badge/1h_41m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 6 | EquityDistribution | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/123-success-brightgreen) | ![](https://img.shields.io/badge/4-failed-orange) | ![](https://img.shields.io/badge/1d_18h_ago-yellow) | ![](https://img.shields.io/badge/1d_19h_ago-yellow) | ![](https://img.shields.io/badge/1h_15m-blue) | ![](https://img.shields.io/badge/1.1x-green) |
| 7 | StockBzPerformance1 | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/11h_9m_ago-blue) | ![](https://img.shields.io/badge/12h_37m_ago-blue) | ![](https://img.shields.io/badge/1h_29m-blue) | ![](https://img.shields.io/badge/1.2x-green) |
| 8 | ShowK_ChartFlow | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/4d_21h_ago-red) | ![](https://img.shields.io/badge/4d_22h_ago-red) | ![](https://img.shields.io/badge/1h_6m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 9 | StockHisAnaQuar | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/3d_21h_ago-orange) | ![](https://img.shields.io/badge/3d_22h_ago-orange) | ![](https://img.shields.io/badge/56m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 10 | EquityDistributionClassHis | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/126-success-brightgreen) | ![](https://img.shields.io/badge/1-failed-orange) | ![](https://img.shields.io/badge/2d_20h_ago-orange) | ![](https://img.shields.io/badge/4d_11h_ago-red) | ![](https://img.shields.io/badge/1h_31m-blue) | ![](https://img.shields.io/badge/1.2x-green) |
| 11 | WeeklyTradingData | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/1d_13h_ago-yellow) | ![](https://img.shields.io/badge/1d_14h_ago-yellow) | ![](https://img.shields.io/badge/1h_15m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 12 | ShowMonthlyK_ChartFlow | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/13h_24m_ago-blue) | ![](https://img.shields.io/badge/14h_38m_ago-blue) | ![](https://img.shields.io/badge/1h_15m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 13 | ShowMarginChart | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/5h_26m_ago-blue) | ![](https://img.shields.io/badge/6h_38m_ago-blue) | ![](https://img.shields.io/badge/1h_12m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 14 | ShowMarginChartWeek | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/4d_13h_ago-red) | ![](https://img.shields.io/badge/4d_14h_ago-red) | ![](https://img.shields.io/badge/1h_13m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 15 | ShowMarginChartMonth | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/7h_30m_ago-blue) | ![](https://img.shields.io/badge/8h_44m_ago-blue) | ![](https://img.shields.io/badge/1h_14m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 16 | StockFinDetail | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/2d_22h_ago-orange) | ![](https://img.shields.io/badge/2d_23h_ago-orange) | ![](https://img.shields.io/badge/1h_4m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |
| 17 | ShowWeeklyK_ChartFlow | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/5d_12h_ago-red) | ![](https://img.shields.io/badge/5d_14h_ago-red) | ![](https://img.shields.io/badge/2h_28m-blue) | ![](https://img.shields.io/badge/1.1x-green) |
| 18 | ShowDailyK_ChartFlow | ![](https://img.shields.io/badge/127-blue) | ![](https://img.shields.io/badge/127-success-brightgreen) |  | ![](https://img.shields.io/badge/now-brightgreen) | ![](https://img.shields.io/badge/1h_14m_ago-blue) | ![](https://img.shields.io/badge/1h_14m-blue) | ![](https://img.shields.io/badge/1.0x-brightgreen) |


## ğŸ“‹ Features

- **No Login Required** - Downloads XLS files directly from export buttons
- **Auto-Updated Stock List** - Downloads latest observation list from GitHub
- **Batch Processing** - Process all stocks automatically with GetAll.py
- **18 Data Types** - Complete coverage of GoodInfo.tw data sources
- **Complete Multi-Frequency Automation** - Weekly + Daily + Monthly scheduling with server-friendly approach
- **Anti-Bot Detection** - Uses undetected-chromedriver for reliability
- **Advanced Special Workflows** - Enhanced handling for complex data types
- **Intelligent Progress Tracking** - CSV-based status monitoring with smart processing

## ğŸ“‚ Repository Structure

```
â”œâ”€â”€ GetGoodInfo.py                   # Main downloader script (v3.2.0.0)
â”œâ”€â”€ GetAll.py                        # Batch processing script
â”œâ”€â”€ Getè§€å¯Ÿåå–®.py                    # Stock list downloader
â”œâ”€â”€ StockID_TWSE_TPEX.csv            # Stock ID and name mappings (auto-updated)
â”œâ”€â”€ requirements.txt                 # Python dependencies
â”œâ”€â”€ .github/workflows/Actions.yaml    # GitHub Actions workflow (Complete Multi-Frequency v3.2.0)
â”œâ”€â”€ .github/workflows/sync.yaml       # GitHub Actions workflow for syncing output data to another repository
â”œâ”€â”€ instructions-GoodInfoDownloader.md # Development instructions (v3.2.0)
â””â”€â”€ README.md                        # This file
```

## ğŸ”§ Installation

1. **Clone the repository**
   ```bash
   git clone https://github.com/your-username/Python-Actions.GoodInfo.git
   cd Python-Actions.GoodInfo
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

3. **Download latest stock list**
   ```bash
   python Getè§€å¯Ÿåå–®.py
   ```

4. **Verify Chrome installation** (for Selenium)
   - Chrome browser will be automatically managed by webdriver-manager

## ğŸ¯ Usage

### Individual Stock Download

```bash
python GetGoodInfo.py STOCK_ID DATA_TYPE
```

### Batch Processing

```bash
python GetAll.py DATA_TYPE [OPTIONS]
```

### Stock List Management

```bash
python Getè§€å¯Ÿåå–®.py
```

### Parameters

- **STOCK_ID**: Taiwan stock code (e.g., 2330, 0050, 2454)
- **DATA_TYPE**: Type of data to download
  - `1` = Dividend Policy (æ®–åˆ©ç‡æ”¿ç­–) - https://goodinfo.tw/tw/StockDividendPolicy.asp?STOCK_ID={stock_id} - Click "XLS" button to get CSV file named as `DividendDetail_{stock_id}_{stock_company}.xls`
  - `2` = Basic Info (åŸºæœ¬è³‡æ–™) - https://goodinfo.tw/tw/BasicInfo.asp?STOCK_ID={stock_id} - Find `å…¬å¸åŸºæœ¬è³‡æ–™` table and convert to XLS
  - `3` = Stock Details (å€‹è‚¡å¸‚æ³) - https://goodinfo.tw/tw/StockDetail.asp?STOCK_ID={stock_id} - Get stock market data
  - `4` = Business Performance (ç¶“ç‡Ÿç¸¾æ•ˆ) - https://goodinfo.tw/tw/StockBzPerformance.asp?STOCK_ID={stock_id} - Click "XLS" button to get CSV file named as `StockBzPerformance_{stock_id}_{stock_company}.xls`
  - `5` = Monthly Revenue (æ¯æœˆç‡Ÿæ”¶) - https://goodinfo.tw/tw/ShowSaleMonChart.asp?STOCK_ID={stock_id} - Click "æŸ¥20å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowSaleMonChart_{stock_id}_{stock_company}.xls`
  - `6` = Equity Distribution (è‚¡æ¬Šçµæ§‹) - https://goodinfo.tw/tw/EquityDistributionCatHis.asp?STOCK_ID={stock_id} - Click "XLS" button to get CSV file named as `EquityDistribution_{stock_id}_{stock_company}.xls`
  - `7` = Quarterly Business Performance (æ¯å­£ç¶“ç‡Ÿç¸¾æ•ˆ) - https://goodinfo.tw/tw/StockBzPerformance.asp?STOCK_ID={stock_id}&YEAR_PERIOD=9999&PRICE_ADJ=F&SCROLL2Y=480&RPT_CAT=M_QUAR - Click "æŸ¥60å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `StockBzPerformance1_{stock_id}_{stock_company}_quarter.xls`
  - `8` = EPS x PER Weekly (æ¯é€±EPSæœ¬ç›Šæ¯”) - https://goodinfo.tw/tw/ShowK_ChartFlow.asp?RPT_CAT=PER&STOCK_ID={stock_id} - Click "æŸ¥5å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowK_ChartFlow_{stock_id}_{stock_company}.xls`
  - `9` = Quarterly Analysis (å„å­£è©³ç´°çµ±è¨ˆè³‡æ–™) - https://goodinfo.tw/tw/StockHisAnaQuar.asp?STOCK_ID={stock_id} - Click "XLS" button to get CSV file named as `StockHisAnaQuar_{stock_id}_{stock_company}.xls`
  - `10` = Equity Class Weekly (è‚¡æ±æŒè‚¡åˆ†é¡é€±) - https://goodinfo.tw/tw/EquityDistributionClassHis.asp?STOCK_ID={stock_id} - Click "æŸ¥5å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `EquityDistributionClassHis_{stock_id}_{stock_company}.xls`
  - `11` = Weekly Trading Data (é€±äº¤æ˜“è³‡æ–™å«ä¸‰å¤§æ³•äºº) - https://goodinfo.tw/tw/ShowK_Chart.asp?STOCK_ID={stock_id}&CHT_CAT=WEEK&PRICE_ADJ=F&SCROLL2Y=600 - Click "æŸ¥5å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `WeeklyTradingData_{stock_id}_{stock_company}.xls`
  - `12` = EPS x PER Monthly (æ¯æœˆEPSæœ¬ç›Šæ¯”) - https://goodinfo.tw/tw/ShowK_ChartFlow.asp?RPT_CAT=PER&STOCK_ID={stock_id}&CHT_CAT=MONTH&SCROLL2Y=439 - Click "æŸ¥20å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowMonthlyK_ChartFlow_{stock_id}_{stock_company}.xls` ğŸ†•
  - `13` = Daily Margin Balance (æ¯æ—¥èè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) - https://goodinfo.tw/tw/ShowMarginChart.asp?STOCK_ID={stock_id}&CHT_CAT=DATE - Click "æŸ¥1å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowMarginChart_{stock_id}_{stock_company}.xls` ğŸ†•
  - `14` = Weekly Margin Balance (æ¯å‘¨èè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) - https://goodinfo.tw/tw/ShowMarginChart.asp?STOCK_ID={stock_id}&PRICE_ADJ=F&CHT_CAT=WEEK&SCROLL2Y=500 - Click "æŸ¥5å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowMarginChartWeek_{stock_id}_{stock_company}.xls` ğŸ†•
  - `15` = Monthly Margin Balance (æ¯æœˆèè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) - https://goodinfo.tw/tw/ShowMarginChart.asp?STOCK_ID={stock_id}&PRICE_ADJ=F&CHT_CAT=MONTH&SCROLL2Y=400 - Click "æŸ¥20å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowMarginChartMonth_{stock_id}_{stock_company}.xls` ğŸ†•
  - `16` = Quarterly Financial Ratio Analysis (å–®å­£è²¡å‹™æ¯”ç‡è¡¨è©³ç´°è³‡æ–™) - https://goodinfo.tw/tw/StockFinDetail.asp?RPT_CAT=XX_M_QUAR&STOCK_ID={stock_id} - Wait 5 seconds for data to load, then click "XLS" button to get CSV file named as `StockFinDetail_{stock_id}_{stock_company}.xls`
  - `17` = Weekly K-Line Chart Flow (é€±Kç·šåœ–è³‡é‡‘æµå‘) - https://goodinfo.tw/tw/ShowK_ChartFlow.asp?RPT_CAT=WEEK&STOCK_ID={stock_id}&CHT_CAT=WEEK - Click "æŸ¥5å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowWeeklyK_ChartFlow_{stock_id}_{stock_company}.xls` ğŸ†•
  - `18` = Daily K-Line Chart Flow (æ—¥Kç·šåœ–è³‡é‡‘æµå‘) - https://goodinfo.tw/tw/ShowK_ChartFlow.asp?RPT_CAT=DATE&STOCK_ID={stock_id}&CHT_CAT=DATE - Click "æŸ¥1å¹´" button and 2 seconds later click "XLS" button to get CSV file named as `ShowDailyK_ChartFlow_{stock_id}_{stock_company}.xls` ğŸ†•

### Batch Options

- `--test` = Process only first 3 stocks (for testing)
- `--debug` = Show detailed error messages
- `--direct` = Simple execution mode

### Examples

#### Individual Downloads
```bash
# Download TSMC dividend data
python GetGoodInfo.py 2330 1

# Download 0050 ETF basic info
python GetGoodInfo.py 0050 2

# Download MediaTek stock details
python GetGoodInfo.py 2454 3

# Download TSMC business performance data
python GetGoodInfo.py 2330 4

# Download TSMC monthly revenue data
python GetGoodInfo.py 2330 5

# Download TSMC equity distribution data
python GetGoodInfo.py 2330 6

# Download TSMC quarterly business performance
python GetGoodInfo.py 2330 7

# Download TSMC EPS x PER weekly data
python GetGoodInfo.py 2330 8

# Download TSMC quarterly analysis data
python GetGoodInfo.py 2330 9

# Download TSMC equity class weekly data
python GetGoodInfo.py 2330 10

# Download TSMC weekly trading data with institutional flows
python GetGoodInfo.py 2330 11

# Download TSMC EPS x PER monthly data (NEW!)
python GetGoodInfo.py 2330 12

# Download TSMC Daily Margin Balance data (NEW!)
python GetGoodInfo.py 2330 13

# Download TSMC Weekly Margin Balance data (NEW!)
python GetGoodInfo.py 2330 14

# Download TSMC Monthly Margin Balance data (NEW!)
python GetGoodInfo.py 2330 15
```

#### Batch Downloads
```bash
# Download dividend data for all stocks
python GetAll.py 1

# Test with first 3 stocks only
python GetAll.py 1 --test

# Download basic info with debug output
python GetAll.py 2 --debug

# Download stock details for all stocks
python GetAll.py 3

# Download business performance for all stocks
python GetAll.py 4

# Download monthly revenue for all stocks
python GetAll.py 5

# Download equity distribution for all stocks
python GetAll.py 6

# Download quarterly performance for all stocks
python GetAll.py 7

# Download EPS x PER weekly for all stocks
python GetAll.py 8

# Download quarterly analysis for all stocks
python GetAll.py 9

# Download equity class weekly for all stocks
python GetAll.py 10

# Download weekly trading data for all stocks
python GetAll.py 11

# Download EPS x PER monthly for all stocks (NEW!)
python GetAll.py 12

# Download Daily Margin Balance for all stocks (NEW!)
python GetAll.py 13

# Download Weekly Margin Balance for all stocks (NEW!)
python GetAll.py 14

# Download Monthly Margin Balance for all stocks (NEW!)
python GetAll.py 15
```

#### Update Stock List
```bash
# Download latest observation list
python Getè§€å¯Ÿåå–®.py
```

## ğŸ“Š Supported Stocks

The script automatically downloads the latest Taiwan stock observation list from GitHub, ensuring you always have the most current stock data available.

### Popular Examples:
- `2330` - å°ç©é›» (TSMC)
- `0050` - å…ƒå¤§å°ç£50
- `2454` - è¯ç™¼ç§‘ (MediaTek)
- `2317` - é´»æµ· (Foxconn)
- `2382` - å»£é” (Quanta)

### Stock List Source:
- **Source**: [GitHub Repository](https://raw.githubusercontent.com/wenchiehlee/GoPublic/refs/heads/main/%E8%A7%80%E5%AF%9F%E5%90%8D%E5%96%AE.csv)
- **Auto-updates**: Run `Getè§€å¯Ÿåå–®.py` to get latest list
- **Format**: CSV with stock ID and company name

### Default Stocks:
- **åŠ æ¬ŠæŒ‡æ•¸ (TAIEX)**: This stock ID is automatically included in batch processing (`GetAll.py`) for all data types. It can also be downloaded individually using its Chinese name (e.g., `python GetGoodInfo.py åŠ æ¬ŠæŒ‡æ•¸ 13`). This allows for comprehensive market-level analysis without needing to manually add it to the stock list.

## ğŸ“‚ Output Structure

Downloaded files are organized by data type:

```
DividendDetail/
â”œâ”€â”€ DividendDetail_2330_å°ç©é›».xls
â”œâ”€â”€ DividendDetail_2317_é´»æµ·.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

BasicInfo/
â”œâ”€â”€ BasicInfo_0050_å…ƒå¤§å°ç£50.xls
â”œâ”€â”€ BasicInfo_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

StockDetail/
â”œâ”€â”€ StockDetail_2330_å°ç©é›».xls
â”œâ”€â”€ StockDetail_2382_å»£é”.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

StockBzPerformance/
â”œâ”€â”€ StockBzPerformance_2330_å°ç©é›».xls
â”œâ”€â”€ StockBzPerformance_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowSaleMonChart/
â”œâ”€â”€ ShowSaleMonChart_2330_å°ç©é›».xls
â”œâ”€â”€ ShowSaleMonChart_2317_é´»æµ·.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

EquityDistribution/
â”œâ”€â”€ EquityDistribution_2330_å°ç©é›».xls
â”œâ”€â”€ EquityDistribution_2317_é´»æµ·.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

StockBzPerformance1/
â”œâ”€â”€ StockBzPerformance1_2330_å°ç©é›»_quarter.xls
â”œâ”€â”€ StockBzPerformance1_2454_è¯ç™¼ç§‘_quarter.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowK_ChartFlow/
â”œâ”€â”€ ShowK_ChartFlow_2330_å°ç©é›».xls
â”œâ”€â”€ ShowK_ChartFlow_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

StockHisAnaQuar/
â”œâ”€â”€ StockHisAnaQuar_2330_å°ç©é›».xls
â”œâ”€â”€ StockHisAnaQuar_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

EquityDistributionClassHis/
â”œâ”€â”€ EquityDistributionClassHis_2330_å°ç©é›».xls
â”œâ”€â”€ EquityDistributionClassHis_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

WeeklyTradingData/
â”œâ”€â”€ WeeklyTradingData_2330_å°ç©é›».xls
â”œâ”€â”€ WeeklyTradingData_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowMonthlyK_ChartFlow/
â”œâ”€â”€ ShowMonthlyK_ChartFlow_2330_å°ç©é›».xls
â”œâ”€â”€ ShowMonthlyK_ChartFlow_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowMarginChart/
â”œâ”€â”€ ShowMarginChart_2330_å°ç©é›».xls
â”œâ”€â”€ ShowMarginChart_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowMarginChartWeek/
â”œâ”€â”€ ShowMarginChartWeek_2330_å°ç©é›».xls
â”œâ”€â”€ ShowMarginChartWeek_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowMarginChartMonth/
â”œâ”€â”€ ShowMarginChartMonth_2330_å°ç©é›».xls
â”œâ”€â”€ ShowMarginChartMonth_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

StockFinDetail/
â”œâ”€â”€ StockFinDetail_2330_å°ç©é›».xls
â”œâ”€â”€ StockFinDetail_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowWeeklyK_ChartFlow/
â”œâ”€â”€ ShowWeeklyK_ChartFlow_2330_å°ç©é›».xls
â”œâ”€â”€ ShowWeeklyK_ChartFlow_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...

ShowDailyK_ChartFlow/
â”œâ”€â”€ ShowDailyK_ChartFlow_2330_å°ç©é›».xls
â”œâ”€â”€ ShowDailyK_ChartFlow_2454_è¯ç™¼ç§‘.xls
â”œâ”€â”€ download_results.csv
â””â”€â”€ ...
```

## ğŸ¤– GitHub Actions Automation

### Complete Multi-Frequency Automation Schedule (v3.2.0)

The repository includes an intelligent GitHub Actions workflow with **complete weekly + daily + monthly scheduling** and **2+ hour gaps** between tasks:

| Slot | Time (UTC) | Time (Taiwan) | Data Type | Description | Update Frequency |
|------|-----------|---------------|-----------|-------------|------------------|
| **SLOT A** | 6:00 AM | 2:00 PM | Type 4 | Business Performance | Weekly (Tue) |
| | 6:00 AM | 2:00 PM | Type 6 | Equity Distribution | Weekly (Wed) |
| | 6:00 AM | 2:00 PM | Type 7 | Quarterly Performance | Weekly (Thu) |
| | 6:00 AM | 2:00 PM | Type 8 | EPS x PER Weekly | Weekly (Fri) |
| | 6:00 AM | 2:00 PM | Type 9 | Quarterly Analysis | Weekly (Sat) |
| | 6:00 AM | 2:00 PM | Type 10 | Equity Class Weekly | Weekly (Sun) |
| **SLOT B** | 10:00 AM | 6:00 PM | Type 1 | Dividend Policy | Daily |
| **SLOT C** | 2:00 PM | 10:00 PM | Type 11 | Weekly Trading Data | Weekly (Mon) |
| | 2:00 PM | 10:00 PM | Type 12 | EPS x PER Monthly | Monthly (1st Tue) |
| | 2:00 PM | 10:00 PM | Type 15 | Monthly Margin Balance | Monthly (1st Wed) |
| | 2:10 PM | 10:10 PM | Type 16 | Quarterly Financial Ratio | Monthly (1st Wed) |
| | 2:00 PM | 10:00 PM | Type 17 | Weekly K-Line Chart Flow | Weekly (Thu) ğŸ†• |
| | 2:00 PM | 10:00 PM | Type 14 | Weekly Margin Balance | Weekly (Fri) |
| **SLOT D** | 6:00 PM | 2:00 AM+1 | Type 5 | Monthly Revenue | Daily |
| **SLOT E** | 10:00 PM | 6:00 AM+1 | Type 13 | Daily Margin Balance | Daily |
| **SLOT F** | 2:00 AM | 10:00 AM | Type 18 | Daily K-Line Chart Flow | Daily ğŸ†• |
| Manual | On-demand | On-demand | Type 2 | Basic Info | Manual only |
| Manual | On-demand | On-demand | Type 3 | Stock Details | Manual only |

**Manual Trigger**: All 18 data types available on-demand via Actions â†’ "Download GoodInfo Data" â†’ Run workflow

### Smart Automation Features

- âœ… **Complete 18 Data Types** - All GoodInfo.tw data sources including K-Line Chart Flow
- âœ… **Multi-Frequency Schedule** - Weekly + Daily + Monthly automation patterns with 2+ hour gaps
- âœ… **Complete Manual Support** - All 18 data types available on-demand
- âœ… **Server-Friendly Operation** - Slot-based distribution prevents server overload
- âœ… Automated stock list updates before each run
- âœ… Batch processing of all stocks in observation list
- âœ… Automated Chrome setup for headless execution
- âœ… Comprehensive file organization and commits
- âœ… Error handling with detailed progress tracking
- âœ… Advanced special workflow support for Types 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, and 18

### Automation Strategy (v3.2.0)

**Complete Multi-Frequency Philosophy:**
- **Weekly Updates**: Non-urgent data (Types 4,6,7,8,9,10,11,14,17) updated weekly for server efficiency
- **Daily Updates**: Time-sensitive data (Types 1,5,13,18) updated daily with 2+ hour gaps
- **Monthly Updates**: Long-term valuation data (Types 12,15,16) updated monthly for comprehensive analysis
- **Slot-Based Timing**: 6 time slots with 2+ hour gaps to accommodate task duration (1-1.5 hours)
- **Complete Coverage**: All 18 data types with comprehensive scheduling
- **Perfect Load Balancing**: Distributed across time slots for optimal performance

**Why This Multi-Frequency Schedule Works:**
- ğŸ“Š **Complete coverage** - All 18 data types with comprehensive multi-timeframe analysis
- ğŸŒ **Server-friendly** - Slot-based distribution with 2+ hour gaps prevents overlap
- âš¡ **Efficient resource usage** - Multi-frequency pattern allows for retry mechanisms
- ğŸ›¡ï¸ **Reduced failure risk** - No schedule conflicts between tasks
- ğŸ“ˆ **Complete data coverage** - All major GoodInfo.tw data sources including K-Line Chart Flow
- â° **Time-sensitive priority** - Revenue and margin data daily, valuation data monthly

## ğŸ”§ Technical Details

### Dependencies

- **selenium**: Browser automation
- **webdriver-manager**: Chrome driver management
- **pandas**: CSV file handling
- **beautifulsoup4**: HTML parsing
- **undetected-chromedriver**: Anti-bot detection bypass
- **requests**: HTTP requests for stock list downloads

### Browser Configuration

- Headless Chrome execution
- Anti-detection measures
- Custom download directories
- Traditional Chinese language support

### Enhanced Error Handling (v3.2.0)

- Graceful fallbacks for missing stock IDs
- Progress tracking for batch operations
- Debug file generation for troubleshooting
- Network timeout protection
- Automatic encoding detection
- Advanced special workflow handling for Types 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, and 18
- Enhanced XLS element detection with 4-tier search methods

### Special Workflow Features

- **Type 5 (Monthly Revenue)**: Automated "æŸ¥20å¹´" button detection and clicking
- **Type 7 (Quarterly Performance)**: Special URL parameters + "æŸ¥60å¹´" button workflow
- **Type 8 (EPS x PER Weekly)**: Special URL parameters + "æŸ¥5å¹´" button workflow
- **Type 9 (Quarterly Analysis)**: Standard XLS download workflow
- **Type 10 (Equity Class Weekly)**: "æŸ¥5å¹´" button + XLS download workflow
- **Type 11 (Weekly Trading Data)**: "æŸ¥5å¹´" button + XLS download workflow
- **Type 12 (EPS x PER Monthly)**: Special URL parameters + "æŸ¥20å¹´" button workflow ğŸ†•
- **Type 13 (Daily Margin Balance)**: Special URL parameters + "æŸ¥1å¹´" button workflow ğŸ†•
- **Type 14 (Weekly Margin Balance)**: Special URL parameters + "æŸ¥5å¹´" button workflow ğŸ†•
- **Type 15 (Monthly Margin Balance)**: Special URL parameters + "æŸ¥20å¹´" button workflow ğŸ†•
- **Enhanced Element Detection**: 4-tier search system for maximum compatibility
- **Debug Screenshots**: Automatic screenshot capture for failed downloads

### Batch Processing Features

- **Progress tracking**: Shows [current/total] progress
- **Error recovery**: Continues processing even if individual stocks fail
- **Summary reporting**: Success/failure statistics
- **Rate limiting**: 1-second delay between requests (2 seconds for special workflows)
- **Test mode**: Process only first 3 stocks for testing
- **Smart automation**: Complete multi-frequency runs with enhanced scheduling

## ğŸ›  Troubleshooting

### Common Issues

1. **CSV file not found**
   - Run: `python Getè§€å¯Ÿåå–®.py` to download stock list
   - Check internet connection

2. **No XLS download elements found**
   - Page structure may have changed
   - Check debug files: `debug_page_{stock_id}.html`
   - Check debug screenshots: `debug_screenshot_{stock_id}.png`
   - Verify stock ID exists on GoodInfo.tw

3. **Module not found errors**
   - Run: `pip install -r requirements.txt`
   - Ensure all dependencies are installed

4. **Batch processing failures**
   - Use `--debug` flag to see detailed errors
   - Use `--test` flag to test with 3 stocks first
   - Check individual stock with `GetGoodInfo.py`

5. **Monthly revenue data issues (DATA_TYPE=5)**
   - Script automatically looks for "æŸ¥20å¹´" button
   - If button not found, check debug output for available elements
   - Some stocks may not have 20-year data available

6. **Quarterly performance data issues (DATA_TYPE=7)**
   - Uses special URL with quarterly parameters
   - Script automatically looks for "æŸ¥60å¹´" button
   - Debug output shows available buttons if not found
   - Some stocks may not have 60-year quarterly data

7. **EPS x PER weekly data issues (DATA_TYPE=8)**
   - Uses special URL with RPT_CAT=PER parameters
   - Script automatically looks for "æŸ¥5å¹´" button
   - Debug output shows available buttons if not found
   - Some stocks may not have 5-year EPS/PER weekly data

8. **Quarterly analysis data issues (DATA_TYPE=9)**
   - Uses standard XLS download workflow
   - Standard XLS element detection patterns
   - Some stocks may not have quarterly analysis data
   - Check debug output if download fails

9. **Equity class weekly data issues (DATA_TYPE=10)**
   - Uses special workflow with "æŸ¥5å¹´" button
   - Script automatically looks for "æŸ¥5å¹´" button followed by XLS download
   - Debug output shows available buttons if not found
   - Some stocks may not have 5-year equity class weekly data

10. **Weekly trading data issues (DATA_TYPE=11)**
    - Uses special workflow with "æŸ¥5å¹´" button for comprehensive weekly trading data
    - Script automatically looks for "æŸ¥5å¹´" button followed by XLS download
    - Includes OHLC, volume, institutional flows, and margin trading data
    - Debug output shows available buttons if not found
    - Some stocks may not have 5-year comprehensive trading data

11. **EPS x PER monthly data issues (DATA_TYPE=12) - NEW!**
    - Uses special URL with CHT_CAT=MONTH parameters
    - Script automatically looks for "æŸ¥20å¹´" button for 20-year monthly data
    - Debug output shows available buttons if not found
    - Some stocks may not have 20-year monthly EPS/PER data
    - Features conservative P/E multiples (9X-19X) for long-term analysis

12. **Daily Margin Balance data issues (DATA_TYPE=13) - NEW!**
    - Uses special URL with CHT_CAT=DATE parameters
    - Script automatically looks for "æŸ¥1å¹´" button for 1-year daily margin data
    - Debug output shows available buttons if not found
    - Some stocks may not have margin trading enabled
    - Tracks daily changes in financing and short selling

13. **Weekly/Monthly Margin Balance data issues (DATA_TYPE=14/15) - NEW!**
    - Type 14 uses "æŸ¥5å¹´" button for weekly margin data
    - Type 15 uses "æŸ¥20å¹´" button for monthly margin data
    - Requires margin trading eligibility
    - Provides longer-term sentiment trend analysis
14. **Quarterly Financial Ratio Analysis data issues (DATA_TYPE=16) - NEW!**
    - Uses special URL with RPT_CAT=XX_M_QUAR parameters
    - Wait 5 seconds before clicking XLS to allow data to load
    - Data provides latest 10-quarter ratio analysis

## ğŸ“ˆ Version History

- **v3.2.1** - Critical Bug Fixes and Reliability Improvements (CURRENT)
  - âœ… **Fixed Type Detection Logic** - Changed from execution time `$(date -u +%H)` to cron expression `github.event.schedule` for reliable type detection
  - âœ… **Added Concurrency Control** - Workflows now queue instead of running concurrently, preventing commit conflicts
  - âœ… **Fixed Type 17/18 URL Parameters** - Added missing `RPT_CAT=WEEK` for Type 17 and `RPT_CAT=DATE` for Type 18
  - âœ… **Robust Schedule Detection** - GitHub Actions delays no longer cause incorrect type fallback

- **v3.2.0** - Complete 18 Data Types with K-Line Chart Flow
  - âœ… **18 Complete Data Types** - Added Weekly K-Line Chart Flow (Type 17) and Daily K-Line Chart Flow (Type 18)
  - âœ… **Slot-Based Scheduling** - Redesigned schedule with 2+ hour gaps to accommodate task duration (1-1.5 hours)
  - âœ… **Complete Fund Flow Coverage** - Weekly and daily K-Line chart flow for institutional trading analysis
  - âœ… **Enhanced Documentation** - Complete usage examples and troubleshooting for all 18 data types
  - âœ… **Six Time Slots** - SLOT A-F design prevents schedule conflicts
  - âœ… Updated GetGoodInfo.py to v3.2.0.0 with full 18-type support and slot-based automation

- **v3.1.0** - Complete 16 Data Types with Quarterly Financial Ratio Analysis
  - âœ… **16 Complete Data Types** - Added Quarterly Financial Ratio Analysis (Type 16) for fundamentals review
  - âœ… **Multi-Frequency Automation** - Optimized scheduling with daily, weekly, and monthly automation patterns
  - âœ… **Complete Valuation & Sentiment Coverage** - P/E analysis plus multi-timeframe margin sentiment tracking
  - âœ… **Enhanced Documentation** - Complete usage examples and troubleshooting for all 16 data types
  - âœ… **Long-Term & Short-Term Analysis** - From 20-year monthly trends to daily margin changes
  - âœ… Updated GetGoodInfo.py to v3.1.0.0 with full 16-type support and multi-frequency automation

## ğŸš€ Quick Start Guide

1. **Setup**
   ```bash
   git clone <repository>
   cd Python-Actions.GoodInfo
   pip install -r requirements.txt
   ```

2. **Download stock list**
   ```bash
   python Getè§€å¯Ÿåå–®.py
   ```

3. **Test all data types**
   ```bash
   python GetAll.py 1 --test    # Dividend data
   python GetAll.py 5 --test    # Monthly revenue (daily automation)
   python GetAll.py 8 --test    # EPS x PER weekly
   python GetAll.py 10 --test   # Equity class weekly
   python GetAll.py 11 --test   # Weekly trading data
   python GetAll.py 12 --test   # EPS x PER monthly (NEW!)
   python GetAll.py 13 --test   # Daily Margin Balance (NEW!)
   python GetAll.py 14 --test   # Weekly Margin Balance (NEW!)
   python GetAll.py 15 --test   # Monthly Margin Balance (NEW!)
   ```

4. **Try individual downloads**
   ```bash
   python GetGoodInfo.py 2330 8    # TSMC EPS x PER weekly
   python GetGoodInfo.py 2330 10   # TSMC equity class weekly
   python GetGoodInfo.py 2330 11   # TSMC weekly trading data
   python GetGoodInfo.py 2330 12   # TSMC EPS x PER monthly (NEW!)
   python GetGoodInfo.py 2330 13   # TSMC Daily Margin Balance (NEW!)
   python GetGoodInfo.py 2330 14   # TSMC Weekly Margin Balance (NEW!)
   ```

5. **Download complete dataset**
   ```bash
   python GetAll.py 1    # All dividend data (Monday automation)
   python GetAll.py 5    # All revenue data (daily automation)
   python GetAll.py 11   # All weekly trading data (Monday evening automation)
   python GetAll.py 12   # All monthly P/E data (monthly automation) (NEW!)
   python GetAll.py 13   # All Daily Margin Balance data (daily evening automation) (NEW!)
   python GetAll.py 14   # All Weekly Margin Balance data (weekly evening automation) (NEW!)
   ```

## ğŸ“Š Complete Data Type Details (v3.2.0)

### 1. Dividend Policy (æ®–åˆ©ç‡æ”¿ç­–)
- **URL**: `StockDividendPolicy.asp?STOCK_ID={stock_id}`
- **Folder**: DividendDetail/
- **Content**: Historical dividend distributions, yield rates, payout ratios
- **Workflow**: Standard XLS download
- **Update**: Daily (SLOT B - 10:00 UTC)

### 2. Basic Info (åŸºæœ¬è³‡æ–™)
- **URL**: `BasicInfo.asp?STOCK_ID={stock_id}`
- **Folder**: BasicInfo/
- **Content**: Company fundamentals, industry classification, listing information
- **Workflow**: Standard XLS download
- **Update**: Manual only (rarely changes)

### 3. Stock Details (å€‹è‚¡å¸‚æ³)
- **URL**: `StockDetail.asp?STOCK_ID={stock_id}`
- **Folder**: StockDetail/
- **Content**: Trading data, price movements, volume analysis
- **Workflow**: Standard XLS download
- **Update**: Manual only (real-time data)

### 4. Business Performance (ç¶“ç‡Ÿç¸¾æ•ˆ)
- **URL**: `StockBzPerformance.asp?STOCK_ID={stock_id}`
- **Folder**: StockBzPerformance/
- **Content**: Financial performance metrics, profitability ratios, operational efficiency
- **Workflow**: Standard XLS download
- **Update**: Weekly (SLOT A - Tuesday 06:00 UTC)

### 5. Monthly Revenue (æ¯æœˆç‡Ÿæ”¶)
- **URL**: `ShowSaleMonChart.asp?STOCK_ID={stock_id}`
- **Folder**: ShowSaleMonChart/
- **Content**: 20-year monthly revenue data, sales trends, growth patterns
- **Workflow**: Special - Click "æŸ¥20å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Daily (SLOT D - 18:00 UTC) - Most time-sensitive

### 6. Equity Distribution (è‚¡æ¬Šçµæ§‹)
- **URL**: `EquityDistributionCatHis.asp?STOCK_ID={stock_id}`
- **Folder**: EquityDistribution/
- **Content**: Shareholder structure, institutional holdings, ownership distribution
- **Workflow**: Standard XLS download
- **Update**: Weekly (SLOT A - Wednesday 06:00 UTC)

### 7. Quarterly Business Performance (æ¯å­£ç¶“ç‡Ÿç¸¾æ•ˆ)
- **URL**: `StockBzPerformance.asp?STOCK_ID={stock_id}&YEAR_PERIOD=9999&PRICE_ADJ=F&SCROLL2Y=480&RPT_CAT=M_QUAR`
- **Folder**: StockBzPerformance1/
- **Content**: Quarterly financial data, seasonal trends, YoY comparisons
- **Workflow**: Special URL â†’ Click "æŸ¥60å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT A - Thursday 06:00 UTC)

### 8. EPS x PER Weekly (æ¯é€±EPSæœ¬ç›Šæ¯”)
- **URL**: `ShowK_ChartFlow.asp?RPT_CAT=PER&STOCK_ID={stock_id}`
- **Folder**: ShowK_ChartFlow/
- **Content**: Weekly EPS and P/E ratio data for 5-year period, technical analysis with 15X-30X multiples
- **Workflow**: Special URL â†’ Click "æŸ¥5å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT A - Friday 06:00 UTC)

### 9. Quarterly Analysis (å„å­£è©³ç´°çµ±è¨ˆè³‡æ–™)
- **URL**: `StockHisAnaQuar.asp?STOCK_ID={stock_id}`
- **Folder**: StockHisAnaQuar/
- **Content**: 4-quarter detailed statistical data, stock price movements, trading volumes, seasonal patterns
- **Workflow**: Standard XLS download (click XLS button)
- **Update**: Weekly (SLOT A - Saturday 06:00 UTC)

### 10. Equity Class Weekly (è‚¡æ±æŒè‚¡åˆ†é¡é€±)
- **URL**: `EquityDistributionClassHis.asp?STOCK_ID={stock_id}`
- **Folder**: EquityDistributionClassHis/
- **Content**: Weekly equity distribution class histogram data for 5-year period, shareholder classification trends
- **Workflow**: Special - Click "æŸ¥5å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT A - Sunday 06:00 UTC)

### 11. Weekly Trading Data (é€±äº¤æ˜“è³‡æ–™å«ä¸‰å¤§æ³•äºº)
- **URL**: `ShowK_Chart.asp?STOCK_ID={stock_id}&CHT_CAT=WEEK&PRICE_ADJ=F&SCROLL2Y=600`
- **Folder**: WeeklyTradingData/
- **Content**: Comprehensive weekly trading data including OHLC prices, volume, institutional flows (å¤–è³‡/æŠ•ä¿¡/è‡ªç‡Ÿ), margin trading, and market microstructure analysis
- **Workflow**: Special - Click "æŸ¥5å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT C - Monday 14:00 UTC)

### 12. EPS x PER Monthly (æ¯æœˆEPSæœ¬ç›Šæ¯”) ğŸ†•
- **URL**: `ShowK_ChartFlow.asp?RPT_CAT=PER&STOCK_ID={stock_id}&CHT_CAT=MONTH&SCROLL2Y=439`
- **Folder**: ShowMonthlyK_ChartFlow/
- **Content**: Monthly EPS and P/E ratio data for 20-year period with conservative P/E multiples (9X-19X), long-term valuation trends, backtesting support
- **Workflow**: Special - Special URL â†’ Click "æŸ¥20å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Monthly (SLOT C - 1st Tuesday 14:00 UTC)

### 13. Daily Margin Balance (æ¯æ—¥èè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) ğŸ†•
- **URL**: `ShowMarginChart.asp?STOCK_ID={stock_id}&CHT_CAT=DATE`
- **Folder**: ShowMarginChart/
- **Content**: Daily margin balance details including financing buy/sell, short selling, margin usage rate, and maintenance rate. 1-year daily history.
- **Workflow**: Special - Special URL â†’ Click "æŸ¥1å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Daily (SLOT E - 22:00 UTC)

### 14. Weekly Margin Balance (æ¯å‘¨èè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) ğŸ†•
- **URL**: `ShowMarginChart.asp?STOCK_ID={stock_id}&PRICE_ADJ=F&CHT_CAT=WEEK&SCROLL2Y=500`
- **Folder**: ShowMarginChartWeek/
- **Content**: Weekly margin balance details with 5-year history for sentiment trend analysis.
- **Workflow**: Special - Special URL â†’ Click "æŸ¥5å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT C - Friday 14:00 UTC)

### 15. Monthly Margin Balance (æ¯æœˆèè³‡èåˆ¸é¤˜é¡è©³ç´°è³‡æ–™) ğŸ†•
- **URL**: `ShowMarginChart.asp?STOCK_ID={stock_id}&PRICE_ADJ=F&CHT_CAT=MONTH&SCROLL2Y=400`
- **Folder**: ShowMarginChartMonth/
- **Content**: Monthly margin balance details with 20-year history for long-term sentiment analysis.
- **Workflow**: Special - Special URL â†’ Click "æŸ¥20å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Monthly (SLOT C - 1st Wednesday 14:00 UTC)

### 16. Quarterly Financial Ratio Analysis (å–®å­£è²¡å‹™æ¯”ç‡è¡¨è©³ç´°è³‡æ–™)
- **URL**: `StockFinDetail.asp?RPT_CAT=XX_M_QUAR&STOCK_ID={stock_id}`
- **Folder**: StockFinDetail/
- **Content**: Quarterly financial ratio analysis with latest 10-quarter data (profitability, efficiency, leverage).
- **Workflow**: Special - Special URL â†’ Wait 5 seconds â†’ XLS download. For full history, downloader auto-paginates with `QRY_TIME=YYYYQ` (10 quarters per block) and merges into a single transposed XLS.
- **Update**: Monthly (SLOT C - 1st Wednesday 14:10 UTC)

### 17. Weekly K-Line Chart Flow (é€±Kç·šåœ–è³‡é‡‘æµå‘) ğŸ†•
- **URL**: `ShowK_ChartFlow.asp?RPT_CAT=WEEK&STOCK_ID={stock_id}&CHT_CAT=WEEK`
- **Folder**: ShowWeeklyK_ChartFlow/
- **Content**: Weekly K-Line chart with fund flow data for 5-year period, including institutional trading patterns and price momentum.
- **Workflow**: Special - Special URL â†’ Click "æŸ¥5å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Weekly (SLOT C - Thursday 14:00 UTC)

### 18. Daily K-Line Chart Flow (æ—¥Kç·šåœ–è³‡é‡‘æµå‘) ğŸ†•
- **URL**: `ShowK_ChartFlow.asp?RPT_CAT=DATE&STOCK_ID={stock_id}&CHT_CAT=DATE`
- **Folder**: ShowDailyK_ChartFlow/
- **Content**: Daily K-Line chart with fund flow data for 1-year period, tracking daily institutional movements and price action.
- **Workflow**: Special - Special URL â†’ Click "æŸ¥1å¹´" â†’ Wait 5 seconds â†’ XLS download
- **Update**: Daily (SLOT F - 02:00 UTC)

## âš–ï¸ Legal Notice

This tool is for educational and research purposes only. Please:
- Respect GoodInfo.tw's terms of service
- Use reasonable request intervals (built-in 1-second delay)
- Don't overload their servers
- Consider subscribing to their premium services for heavy usage

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch
3. Test with `--test` flag first
4. Make your changes
5. Test thoroughly with all 18 data types
6. Submit a pull request

## ğŸ“ Support

- **Issues**: Use GitHub Issues for bug reports
- **Discussions**: Use GitHub Discussions for questions
- **Updates**: Watch the repository for new releases

## ğŸ¯ Roadmap

- [ ] Support for additional GoodInfo.tw data pages
- [ ] Enhanced data validation and quality checks
- [ ] Export to multiple formats (CSV, JSON)
- [ ] Real-time data monitoring capabilities
- [ ] Performance optimization for large-scale downloads
- [ ] Advanced filtering and sorting options

## ğŸ† Success Tips

### Leveraging Complete 18-Type Slot-Based Automation (v3.2.0):
- ğŸ“… **Slot-Based Scheduling**: 6 time slots (A-F) with 2+ hour gaps to prevent overlap
- ğŸ“Š **Complete Coverage**: All 18 data types available with comprehensive automation
- ğŸ• **Predictable Timing**: Tasks complete before next slot starts (1-1.5 hour task duration)
- ğŸ“± **Manual Access**: All 18 data types available 24/7 via manual triggers

### For New Data Type 12 (EPS x PER Monthly):
- ğŸ“ˆ **Type 12**: Best for long-term valuation analysis with 20-year monthly data (monthly automation)
- ğŸ“Š **Complete P/E Coverage**: Conservative multiples (9X-19X) vs Type 8's aggressive (15X-30X)
- ğŸ•˜ Special workflow - includes "æŸ¥20å¹´" button handling for extended historical coverage
- ğŸ” Check debug output if special workflow fails
- ğŸ“… Complements Type 8 weekly analysis with monthly long-term perspective

### For New Data Type 13 (Daily Margin Balance):
- ğŸ“‰ **Type 13**: Critical for analyzing market sentiment and retail vs. institutional positioning
- ğŸ“Š **Daily Updates**: Tracks daily changes in margin utilization and short interest
- ğŸ•˜ Special workflow - includes "æŸ¥1å¹´" button handling for daily history
- ğŸ” Check debug output if special workflow fails
- ğŸ“… Complements Type 11 weekly trading data with granular daily margin stats

### For New Data Types 14 & 15 (Weekly/Monthly Margin Balance):
- ğŸ“‰ **Type 14/15**: Medium to long-term sentiment trend analysis
- ğŸ“Š **Extended History**: 5-year (Weekly) and 20-year (Monthly) coverage
- ğŸ•˜ Special workflows - includes "æŸ¥5å¹´" and "æŸ¥20å¹´" button handling
- ğŸ” Enables long-term margin cycle analysis and backtesting

### For New Data Type 16 (Quarterly Financial Ratio Analysis):
- ğŸ“‰ **Type 16**: Quarterly fundamentals view with latest 10-quarter ratio table
- ğŸ“Š **Ratio Coverage**: Profitability, efficiency, growth, leverage indicators
- ğŸ•˜ Special workflow - wait 5 seconds before downloading XLS
- ğŸ” Useful alongside Types 7 and 9 for deeper quarterly analysis

### For New Data Type 17 (Weekly K-Line Chart Flow) ğŸ†•:
- ğŸ“ˆ **Type 17**: Weekly K-Line chart with institutional fund flow patterns
- ğŸ“Š **5-Year History**: Tracks weekly price action and fund movements
- ğŸ•˜ Special workflow - includes "æŸ¥5å¹´" button handling
- ğŸ” Complements Type 8 (EPS x PER Weekly) for technical analysis

### For New Data Type 18 (Daily K-Line Chart Flow) ğŸ†•:
- ğŸ“‰ **Type 18**: Daily K-Line chart with institutional fund flow tracking
- ğŸ“Š **1-Year History**: Granular daily price action and fund movements
- ğŸ•˜ Special workflow - includes "æŸ¥1å¹´" button handling
- ğŸ” Complements Type 13 (Daily Margin Balance) for short-term analysis

### For All Data Types:
- ğŸ§ª Always test with `--test` flag first
- ğŸ“„ Use batch processing for multiple stocks
- ğŸ” Check debug files and screenshots if downloads fail
- â° Respect rate limits (1-second delay built-in, 2 seconds for special workflows)
- ğŸ¤– **Complete**: Leverage slot-based automation for optimal data freshness across all timeframes

---

**â­ Star this repository if it helps you with Taiwan stock data analysis!**

**ğŸ†• New in v3.2.1: Critical bug fixes for reliable type detection and concurrency control!**

**ğŸ“… Slot-based scheduling: 6 time slots with 2+ hour gaps for reliable automation!**

**ğŸš€ Complete coverage of GoodInfo.tw data sources with comprehensive fund flow and sentiment analysis support!**
